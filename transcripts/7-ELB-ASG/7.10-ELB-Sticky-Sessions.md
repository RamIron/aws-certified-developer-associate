# 7.10 - Elastic Load Balancer - Sticky Sessions

## Key Concepts

### 1. What are Sticky Sessions?
- Also called **session affinity**
- A client making multiple requests will always be routed to the **same backend instance**
- Works on **CLB, ALB, and NLB**
- ALB/CLB: implemented using a **cookie** with an expiration date — when it expires, the client may be redirected to a different instance
- NLB: stickiness is not cookie-based (uses source IP instead)

### 2. Use Case & Trade-off
- **Use case:** Keep a user on the same instance to preserve **session data** (e.g., login state)
- **Trade-off:** Can cause **load imbalance** — some instances may get more traffic than others if certain users are "sticky" for a long time

### 3. Two Types of Cookies

| Type                  | Generated By     | Duration Set By     | Cookie Name           |
|-----------------------|------------------|---------------------|-----------------------|
| Application-based     | Your application (custom) | Your application | Your custom name (not AWSALB/AWSALBAPP/AWSALBTG) |
| Application-based     | Load balancer    | Load balancer       | **AWSALBAPP**         |
| Duration-based        | Load balancer    | Load balancer       | **AWSALB** (ALB) / **AWSELB** (CLB) |

**Reserved cookie names (do NOT use):**
- AWSALB
- AWSALBAPP
- AWSALBTG

### 4. Stickiness Configuration
- Configured at the **target group level** (not at the load balancer level)
- Options: load balancer generated cookie OR application-based cookie
- Duration: 1 second to 7 days

---

## Exam Tips
- Sticky sessions = same client → same instance
- ALB/CLB use cookies; NLB uses source IP (no cookies)
- Works on CLB, ALB, and NLB
- Can cause load imbalance
- Two types: application-based cookies and duration-based cookies
- Reserved cookie names: AWSALB, AWSALBAPP, AWSALBTG — don't use these for custom cookies
- Configured at the **target group** level
