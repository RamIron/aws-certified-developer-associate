# 7.12 - Elastic Load Balancer - SSL Certificates

## Key Concepts

### 1. SSL/TLS Basics
- **SSL** (Secure Sockets Layer) and **TLS** (Transport Layer Security) encrypt traffic **in-flight** between client and load balancer
- TLS is the newer, more secure version — but people still call it "SSL" colloquially
- SSL/TLS certificates use the **X.509** format
- Certificates have an **expiration date** and must be renewed

### 2. How SSL Works with Load Balancers

```
Users ──── HTTPS (encrypted) ────► [Load Balancer] ──── HTTP (private VPC) ────► EC2 Instances
                                    SSL termination
                                    happens here
```

- The load balancer performs **SSL termination**: it decrypts the HTTPS traffic
- Traffic between the LB and backend instances travels over the **private VPC network** (HTTP)
- The LB uses an **X.509 certificate** (SSL/TLS server certificate)

### 3. AWS Certificate Manager (ACM)
- AWS service to **manage and provision** SSL/TLS certificates
- You can upload your own certificates to ACM as an alternative
- ACM handles renewal automatically for certificates it provisions

### 4. HTTPS Listener Configuration
- You must specify a **default certificate**
- You can add an **optional list of additional certificates** (to support multiple domains)
- Clients can use **SNI** to specify which hostname they want to reach
- You can set a **security policy** to support older SSL/TLS versions (for legacy clients)

### 5. SNI - Server Name Indication
- Solves the problem of **loading multiple SSL certificates onto one server/load balancer**
- The client indicates the **target hostname** in the initial SSL handshake
- The server then finds and uses the **correct certificate** for that hostname

```
                         ┌─ "domain1.com" cert ──► Target Group 1
Client ── SNI header ──► │
   "I want domain2.com"  ├─ "domain2.com" cert ──► Target Group 2
                         │
                         └─ "domain3.com" cert ──► Target Group 3

                         ALB / NLB with multiple SSL certificates
```

- **Newer protocol** — not all clients support it (but most modern ones do)
- **Supported by:** ALB, NLB, and CloudFront
- Does NOT work on older load balancers

### 6. ALB & NLB SSL Support

| Feature | ALB | NLB |
|---------|-----|-----|
| Supports SNI | Yes | Yes |
| Multiple SSL certs | Yes (via SNI) | Yes (via SNI) |
| Multiple listeners | Yes | Yes |
| Routing with SNI | Routes to different target groups based on hostname | Routes to different target groups based on hostname |

---

## Exam Tips
- SSL/TLS provides **in-flight encryption** (HTTPS)
- Load balancers perform **SSL termination** — decrypt traffic before forwarding to instances
- **ACM** is used to manage SSL/TLS certificates on AWS
- **SNI** allows multiple SSL certificates on one load balancer — works on **ALB and NLB**
- Clients use SNI to indicate which hostname they want in the SSL handshake
- The LB picks the correct certificate based on the SNI hostname
- **Exam trap:** "multiple SSL certificates on one listener" → answer is SNI
