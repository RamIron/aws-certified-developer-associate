# 6.10 - Amazon EFS

## Key Concepts

### 1. What is EFS?
- **EFS** = Elastic File System = managed **NFS** (Network File System)
- Can be mounted on **many EC2 instances simultaneously**, across **multiple AZs**
- Highly available, scalable, expensive (~3x cost of gp2 EBS)
- **Pay-per-use** — no capacity planning needed, scales automatically
- Requires a **security group** to control access
- **Linux-only** — NOT compatible with Windows AMIs
- Supports encryption at rest via **KMS**
- Uses **POSIX** standard file system with standard file API

### 2. Use Cases
- Content management, web serving, data sharing, WordPress
- Any workload needing shared file access across multiple EC2 instances or AZs

### 3. Performance Modes (set at creation time)

| Mode            | Latency    | Throughput | Best For                              |
|-----------------|------------|------------|---------------------------------------|
| General Purpose | Low        | Normal     | Web servers, CMS (default)            |
| Max I/O         | Higher     | Very high  | Big data, media processing (parallel) |

### 4. Throughput Modes

| Mode        | How It Works                                          | Best For                        |
|-------------|-------------------------------------------------------|---------------------------------|
| Bursting    | Throughput scales with storage size                   | Variable workloads              |
| Provisioned | Set throughput independently of storage size          | Predictable high-throughput     |
| Elastic     | Auto-scales up/down based on workload (up to 3 GiB/s reads, 1 GiB/s writes) | Unpredictable workloads |

### 5. Storage Classes (Tiers)

| Tier         | Access Pattern          | Cost                        |
|--------------|-------------------------|-----------------------------|
| Standard     | Frequently accessed     | Higher storage cost          |
| EFS-IA       | Infrequent access       | Lower storage + retrieval fee|
| Archive      | Rarely accessed (few times/year) | Cheapest storage     |

- **Lifecycle policies** automatically move files between tiers after N days of no access
- Example: file not accessed for 60 days → auto-moved from Standard to EFS-IA

### 6. Availability Options

| Option    | AZ Coverage | Use Case          | Notes                          |
|-----------|-------------|-------------------|--------------------------------|
| Standard  | Multi-AZ    | Production        | Resilient to AZ failures       |
| One Zone  | Single AZ   | Dev/Test          | Cheaper, compatible with IA    |

- **EFS One Zone-IA** = cheapest combination (single AZ + infrequent access)
- Up to **90% cost savings** with right storage class selection

---

## Exam Tips
- EFS = **network file system**, mountable by many EC2s across AZs simultaneously
- **Linux only** — Windows cannot use EFS
- ~3x more expensive than gp2 EBS, but pay-per-use
- Performance mode: **General Purpose** (default) vs **Max I/O** (big data, parallel)
- Throughput mode: **Elastic** = best for unpredictable workloads
- Storage tiers: Standard → EFS-IA → Archive (decreasing access frequency)
- **Lifecycle policies** move files between tiers automatically
- **One Zone-IA** = most cost-effective option
